---
layout: news_post
title: "CVE-2021-28966: Lỗ hổng path traversal trong Tempfile trên Windows"
author: "mame"
translator:
date: 2021-04-05 12:00:00 +0000
tags: security
lang: vi
---

Một lỗ hổng tạo thư mục ngoài ý muốn đã được phát hiện trong thư viện tmpdir đi kèm với Ruby trên Windows. Và cũng có lỗ hổng tạo tệp ngoài ý muốn trong thư viện tempfile đi kèm với Ruby trên Windows, vì nó sử dụng tmpdir nội bộ. Lỗ hổng này đã được gán mã định danh CVE [CVE-2021-28966](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28966).

## Chi tiết

Phương thức `Dir.mktmpdir` được giới thiệu bởi thư viện tmpdir chấp nhận tiền tố và hậu tố của thư mục được tạo làm tham số đầu tiên. Tiền tố có thể chứa các chỉ định thư mục tương đối `"..\\"`, vì vậy phương thức này có thể được sử dụng để nhắm đến bất kỳ thư mục nào. Do đó, nếu một script chấp nhận đầu vào bên ngoài làm tiền tố, và thư mục đích có quyền không phù hợp hoặc tiến trình ruby có đặc quyền không phù hợp, kẻ tấn công có thể tạo thư mục hoặc tệp tại bất kỳ thư mục nào.

Đây là cùng một vấn đề như [CVE-2018-6914](https://www.ruby-lang.org/vi/news/2018/03/28/unintentional-file-and-directory-creation-with-directory-traversal-cve-2018-6914/), nhưng bản sửa trước đó chưa hoàn chỉnh trên Windows.

Tất cả người dùng đang chạy phiên bản bị ảnh hưởng nên nâng cấp ngay lập tức.

## Các phiên bản bị ảnh hưởng

* Ruby 2.7.2 hoặc trước đó
* Ruby 3.0.0

## Ghi công

Cảm ơn [Bugdiscloseguys](https://hackerone.com/bugdiscloseguys) đã phát hiện vấn đề này.

## Lịch sử

* Originally published at 2021-04-05 12:00:00 (UTC)
