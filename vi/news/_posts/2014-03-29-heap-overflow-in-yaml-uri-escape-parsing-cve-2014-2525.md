---
layout: news_post
title: "Tràn bộ nhớ Heap trong phân tích YAML URI Escape (CVE-2014-2525)"
author: "hone and zzak"
translator:
date: 2014-03-29 01:49:25 +0000
tags: security
lang: vi
---

Có một lỗi tràn bộ nhớ trong phân tích URI escape của YAML trong Ruby.
Lỗ hổng này đã được gán mã định danh CVE
[CVE-2014-2525](http://www.ocert.org/advisories/ocert-2014-003.html).

## Chi tiết

Bất cứ khi nào một chuỗi trong YAML có tag được phân tích, một chuỗi được tạo
đặc biệt có thể gây ra tràn heap dẫn đến thực thi mã tùy ý.

Ví dụ:

{% highlight ruby %}
YAML.load <code_from_unknown_source>
{% endhighlight %}

## Các phiên bản bị ảnh hưởng

Ruby 1.9.3-p0 trở lên bao gồm psych làm bộ phân tích YAML mặc định.
Bất kỳ phiên bản psych nào liên kết với libyaml `<= 0.1.5` đều bị ảnh hưởng.

Và, các phiên bản Ruby sau đi kèm phiên bản libyaml bị ảnh hưởng:

* Ruby 2.0.0-p451 và trước đó,
* Ruby 2.1.0 và Ruby 2.1.1.

Bạn có thể xác minh phiên bản libyaml đang sử dụng bằng lệnh:

{% highlight sh %}
$ ruby -rpsych -e 'p Psych.libyaml_version'
[0, 1, 5]
{% endhighlight %}

## Giải pháp

Người dùng cài đặt libyaml trên hệ thống được khuyến nghị cập nhật libyaml lên `0.1.6`.
Khi biên dịch lại Ruby, trỏ đến libyaml vừa cập nhật:

{% highlight sh %}
$ ./configure --with-yaml-dir=/path/to/libyaml
{% endhighlight %}

Người dùng không có libyaml hệ thống dựa vào libyaml nhúng được khuyến nghị
cập nhật psych lên `2.0.5` có đi kèm libyaml `0.1.6`:

{% highlight sh %}
$ gem install psych
{% endhighlight %}

hoặc, cập nhật Ruby của bạn lên 2.0.0-p481, 2.1.2 hoặc mới hơn.

## Lịch sử

* Công bố lần đầu vào 2014-03-29 01:49:25 UTC
* Cập nhật công bố vào 2014-03-29 09:37:00 UTC
* Cập nhật công bố vào 2014-05-09 03:00:00 UTC
