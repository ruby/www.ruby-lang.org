---
layout: news_post
title: "CVE-2021-28966: Path traversal в Tempfile на Windows"
author: "mame"
translator: "Andrii Furmanets"
date: 2021-04-05 12:00:00 +0000
tags: security
lang: uk
---

Є вразливість ненавмисного створення директорії в бібліотеці tmpdir, включеній в Ruby на Windows. А також є вразливість ненавмисного створення файлу в бібліотеці tempfile, включеній в Ruby на Windows, оскільки вона використовує tmpdir внутрішньо. Цій вразливості присвоєно ідентифікатор CVE [CVE-2021-28966](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28966).

## Деталі

Метод `Dir.mktmpdir`, введений бібліотекою tmpdir, приймає префікс та суфікс директорії, яка створюється, як перший параметр. Префікс може містити відносні специфікатори директорії `"..\\"`, тому цей метод може бути використаний для націлювання на будь-яку директорію. Тому, якщо скрипт приймає зовнішній ввід як префікс, і цільова директорія має невідповідні дозволи або процес ruby має невідповідні привілеї, зловмисник може створити директорію або файл у будь-якій директорії.

Це та сама проблема, що й [CVE-2018-6914](https://www.ruby-lang.org/uk/news/2018/03/28/unintentional-file-and-directory-creation-with-directory-traversal-cve-2018-6914/), але попереднє виправлення було неповним на Windows.

Всі користувачі, які запускають зачеплений випуск, повинні оновитися негайно.

## Зачеплені версії

* Ruby 2.7.2 або раніше
* Ruby 3.0.0

## Подяка

Дякую [Bugdiscloseguys](https://hackerone.com/bugdiscloseguys) за виявлення цієї проблеми.

## Історія

* Спочатку опубліковано 2021-04-05 12:00:00 (UTC)