---
layout: news_post
title: "Вразливість доступу до файлів WEBrick"
author: "Shugo Maeda"
translator: "Andrii Furmanets"
lang: uk
---

WEBrick, стандартна бібліотека Ruby для реалізації HTTP серверів, має вразливість
доступу до файлів.

## Вплив

Наступні програми вразливі.

1.  Програми, які публікують файли, використовуючи `WEBrick::HTTPServer.new` з
    опцією `:DocumentRoot`
2.  Програми, які публікують файли, використовуючи
    `WEBrick::HTTPServlet::FileHandler`

Зачеплені системи:

1.  Системи, які приймають зворотну косую риску (\\) як роздільник шляху, такі як
    Windows.
2.  Системи, які використовують файлові системи без урахування регістру, такі як NTFS на
    Windows, HFS на Mac OS X.

Ця вразливість має наступний вплив.

1.  Зловмисник може отримати доступ до приватних файлів, надсилаючи url з url-кодованою
    зворотною косою рискою (\\). Цей експлойт працює лише на системах, які приймають
    зворотну косую риску як роздільник шляху.

    Приклад:

        http://[server]:[port]/..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/boot.ini

2.  Зловмисник може отримати доступ до файлів, які відповідають шаблонам, вказаним
    опцією `:NondisclosureName` (значення за замовчуванням `[".ht*",
    "*~"]`). Цей експлойт працює лише на системах, які використовують файлові системи без урахування
    регістру.

## Вразливі версії

Серія 1.8
: * 1\.8.4 та всі попередні версії
  * 1\.8.5-p114 та всі попередні версії
  * 1\.8.6-p113 та всі попередні версії

Серія 1.9
: * 1\.9.0-1 та всі попередні версії

## Рішення

Серія 1.8
: Будь ласка, оновіться до 1.8.5-p115 або 1.8.6-p114.

  * [&lt;URL:https://cache.ruby-lang.org/pub/ruby/1.8/ruby-1.8.5-p115.tar.gz&gt;][1]
    (md5sum: 20ca6cc87eb077296806412feaac0356)
  * [&lt;URL:https://cache.ruby-lang.org/pub/ruby/1.8/ruby-1.8.6-p114.tar.gz&gt;][2]
    (md5sum: 500a9f11613d6c8ab6dcf12bec1b3ed3)

Серія 1.9
: Будь ласка, застосуйте наступний патч до
  lib/webrick/httpservlet/filehandler.rb.

  * [&lt;URL:https://cache.ruby-lang.org/pub/ruby/1.9/ruby-1.9.0-1-webrick-vulnerability-fix.diff&gt;][3]
    (md5sum: b7b58aed40fa1609a67f53cfd3a13257)

Будь ласка, зверніть увагу, що пакет, який виправляє цю слабкість, може вже бути
доступний через ваше програмне забезпечення управління пакетами.

## Подяка

Подяка Digital Security Research Group
([&lt;URL:http://dsec.ru/&gt;][4]) за розкриття проблеми команді безпеки Ruby.




[1]: https://cache.ruby-lang.org/pub/ruby/1.8/ruby-1.8.5-p115.tar.gz
[2]: https://cache.ruby-lang.org/pub/ruby/1.8/ruby-1.8.6-p114.tar.gz
[3]: https://cache.ruby-lang.org/pub/ruby/1.9/ruby-1.9.0-1-webrick-vulnerability-fix.diff
[4]: http://dsec.ru/