---
layout: news_post
title: "CVE-2021-41817: Regular Expression Denial of Service Vunlerability of Date Parsing Methods"
author: "mame"
translator:
date: 2021-11-15 12:00:00 +0000
tags: security
lang: en
---

Regular expression denial of service vulnerability of date parsing methods was found. An attacker can exploit this vulnerability to cause an effective denial of service.

## Details

Date's parsing methods including `Date.parse` are using Regexps internally, some of which are vulnerable against regular expression denial of service. Applications and libraries that apply such methods to untrusted input may be affected.

The fix limits the input length up to 128 bytes by default instead of changing the regexps. This is because Date gem uses many Regexps and it is possible that there are still undiscovered vulnerable Regexps. For compatibility, it is allowed to remove the limitation by explicitly passing `limit` keywords as `nil` like `Date.parse(str, limit: nil)`, but note that it may take a long time to parse.

Please update the date gem to version 3.2.1, 3.1.2, 3.0.2, and 2.0.1, or later.  You can use `gem update date` to update it.  If you are using bundler, please add `gem "date", ">= 3.2.1"` to your `Gemfile`.

## Affected versions

* date gem 2.0.0 or prior (which are bundled versions with Ruby 2.6 series)
* date gem 3.0.1 or prior (which are bundled versions with Ruby 2.7 series)
* date gem 3.1.1 or prior (which are bundled versions with Ruby 3.0 series)
* date gem 3.2.0 or prior

## Credits

Thanks to [svalkanov](https://hackerone.com/svalkanov) for discovering this issue.

## History

* Originally published at 2021-11-15 12:00:00 (UTC)
